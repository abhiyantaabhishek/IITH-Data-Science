<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.251">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Abhishek Kumar Dubey">
<meta name="dcterms.date" content="2022-08-20">
<meta name="description" content="Classification Error, ROC/PR curve, KNN">

<title>IITH-Data-Science - Machine Learning 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../posts/CS5590/2022-08-27-CS5590-week3.html" rel="next">
<link href="../../posts/CS5590/2022-08-06-CS5590-week1.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-5ZQX02R26E"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-5ZQX02R26E', { 'anonymize_ip': true});
</script>

  <script>window.backupDefine = window.define; window.define = undefined;</script><script src="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js"></script>
  <script>document.addEventListener("DOMContentLoaded", function () {
 var mathElements = document.getElementsByClassName("math");
 var macros = [];
 for (var i = 0; i < mathElements.length; i++) {
  var texText = mathElements[i].firstChild;
  if (mathElements[i].tagName == "SPAN") {
   katex.render(texText.data, mathElements[i], {
    displayMode: mathElements[i].classList.contains('display'),
    throwOnError: false,
    macros: macros,
    fleqn: false
   });
}}});
  </script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css">

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="IITH-Data-Science - Machine Learning 2">
<meta property="og:description" content="Classification Error, ROC/PR curve, KNN">
<meta property="og:image" content="CS5590_images/chrome_CNeo323E9V.png">
<meta property="og:site-name" content="IITH-Data-Science">
</head>

<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IITH-Data-Science</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">Home</a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">About</a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/abhiyantaabhishek"><i class="bi bi-github" role="img">
</i> 
 </a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/abhishek-kumar-dubey-585a86179/"><i class="bi bi-linkedin" role="img">
</i> 
 </a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Machine Learning 2</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title d-none d-lg-block">Machine Learning 2</h1>
                  <div>
        <div class="description">
          Classification Error, ROC/PR curve, KNN
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">Machine Learning</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Abhishek Kumar Dubey </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">August 20, 2022</p>
      </div>
    </div>
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">CS6660</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">Probability Theory</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS6660/2022-08-06-CS6660-week1.html" class="sidebar-item-text sidebar-link">Probability Theory 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS6660/2022-08-13-CS6660-week2.html" class="sidebar-item-text sidebar-link">Probability Theory 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS6660/2022-09-17-CS6660-week4_1.html" class="sidebar-item-text sidebar-link">Probability Theory 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS6660/2022-09-24-CS6660-week5.html" class="sidebar-item-text sidebar-link">Probability Theory 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS6660/2022-10-15-CS6660-week7.html" class="sidebar-item-text sidebar-link">Probability Theory 5</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Linear Algebra</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS6660/2022-09-03-CS6660-week3.html" class="sidebar-item-text sidebar-link">Linear Algebra 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS6660/2022-09-17-CS6660-week4_2.html" class="sidebar-item-text sidebar-link">Linear Algebra 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS6660/2022-10-01-CS6660-week6.html" class="sidebar-item-text sidebar-link">Linear Algebra 3</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">CS5590</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">Machine Learning</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS5590/2022-08-06-CS5590-week1.html" class="sidebar-item-text sidebar-link">Machine Learning 1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS5590/2022-08-20-CS5590-week2.html" class="sidebar-item-text sidebar-link active">Machine Learning 2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS5590/2022-08-27-CS5590-week3.html" class="sidebar-item-text sidebar-link">Machine Learning 3</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS5590/2022-09-10-CS5590-week4.html" class="sidebar-item-text sidebar-link">Machine Learning 4</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS5590/2022-09-24-CS5590-week5.html" class="sidebar-item-text sidebar-link">Machine Learning 5</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS5590/2022-10-08-CS5590-week6.html" class="sidebar-item-text sidebar-link">Machine Learning 6</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../posts/CS5590/2022-10-15-CS5590-week7.html" class="sidebar-item-text sidebar-link">Machine Learning 7</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#evaluation-measures" id="toc-evaluation-measures" class="nav-link active" data-scroll-target="#evaluation-measures"><span class="toc-section-number">1</span>  Evaluation Measures</a></li>
  <li><a href="#is-accuracy-adequate" id="toc-is-accuracy-adequate" class="nav-link" data-scroll-target="#is-accuracy-adequate"><span class="toc-section-number">2</span>  Is accuracy adequate</a></li>
  <li><a href="#classification-error" id="toc-classification-error" class="nav-link" data-scroll-target="#classification-error"><span class="toc-section-number">3</span>  Classification Error</a></li>
  <li><a href="#utility-and-cost" id="toc-utility-and-cost" class="nav-link" data-scroll-target="#utility-and-cost"><span class="toc-section-number">4</span>  Utility and cost</a></li>
  <li><a href="#roc-curve" id="toc-roc-curve" class="nav-link" data-scroll-target="#roc-curve"><span class="toc-section-number">5</span>  ROC curve</a></li>
  <li><a href="#precision-recall-curve" id="toc-precision-recall-curve" class="nav-link" data-scroll-target="#precision-recall-curve"><span class="toc-section-number">6</span>  Precision Recall Curve</a></li>
  <li><a href="#a-nice-way-to-define-precision-recall-etc." id="toc-a-nice-way-to-define-precision-recall-etc." class="nav-link" data-scroll-target="#a-nice-way-to-define-precision-recall-etc."><span class="toc-section-number">7</span>  A nice way to define precision recall etc.</a></li>
  <li><a href="#roc-curve-vs-pr-curve" id="toc-roc-curve-vs-pr-curve" class="nav-link" data-scroll-target="#roc-curve-vs-pr-curve"><span class="toc-section-number">8</span>  ROC curve vs PR curve</a></li>
  <li><a href="#other-performance-measures" id="toc-other-performance-measures" class="nav-link" data-scroll-target="#other-performance-measures"><span class="toc-section-number">9</span>  Other performance measures</a></li>
  <li><a href="#important-points" id="toc-important-points" class="nav-link" data-scroll-target="#important-points"><span class="toc-section-number">10</span>  Important points</a></li>
  <li><a href="#k-nearest-neighbors" id="toc-k-nearest-neighbors" class="nav-link" data-scroll-target="#k-nearest-neighbors"><span class="toc-section-number">11</span>  K-Nearest Neighbors</a>
  <ul class="collapse">
  <li><a href="#basic-idea" id="toc-basic-idea" class="nav-link" data-scroll-target="#basic-idea"><span class="toc-section-number">11.1</span>  basic idea</a></li>
  <li><a href="#how-to-determinke-k" id="toc-how-to-determinke-k" class="nav-link" data-scroll-target="#how-to-determinke-k"><span class="toc-section-number">11.2</span>  How to determinke K</a></li>
  <li><a href="#improvements" id="toc-improvements" class="nav-link" data-scroll-target="#improvements"><span class="toc-section-number">11.3</span>  Improvements</a></li>
  <li><a href="#pros" id="toc-pros" class="nav-link" data-scroll-target="#pros"><span class="toc-section-number">11.4</span>  Pros</a></li>
  <li><a href="#cons" id="toc-cons" class="nav-link" data-scroll-target="#cons"><span class="toc-section-number">11.5</span>  Cons</a></li>
  <li><a href="#convergence-of-1-nn" id="toc-convergence-of-1-nn" class="nav-link" data-scroll-target="#convergence-of-1-nn"><span class="toc-section-number">11.6</span>  Convergence of 1-NN</a></li>
  <li><a href="#density-estimation-using-knn" id="toc-density-estimation-using-knn" class="nav-link" data-scroll-target="#density-estimation-using-knn"><span class="toc-section-number">11.7</span>  Density Estimation using KNN</a></li>
  <li><a href="#knn-example-using-sklearn" id="toc-knn-example-using-sklearn" class="nav-link" data-scroll-target="#knn-example-using-sklearn"><span class="toc-section-number">11.8</span>  KNN example using sklearn</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="evaluation-measures" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="evaluation-measures"><span class="header-section-number">1</span> Evaluation Measures</h2>
<ul>
<li>Classification
<ul>
<li>It is a measure of being right/wrong,0-1, eg: hinge loss, cross entropy loss</li>
</ul></li>
<li>Regression loss
<ul>
<li>It is a measure if how close we are to target, eg: MEA, MES</li>
</ul></li>
<li>Ranking/search
<ul>
<li>It is a measure of top K search</li>
</ul></li>
<li>Clustering
<ul>
<li>How well we have described the data ( not straight forward)</li>
</ul></li>
</ul>
</section>
<section id="is-accuracy-adequate" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="is-accuracy-adequate"><span class="header-section-number">2</span> Is accuracy adequate</h2>
<p>Accuracy may not not be useful in cases where:</p>
<ul>
<li>There is a large class skew.</li>
<li>There are differential misclassification cost, say getting a positive wrong costs more than getting a negative wrong.</li>
<li>we are most interested in a subset of high confidence predictions.</li>
</ul>
</section>
<section id="classification-error" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="classification-error"><span class="header-section-number">3</span> Classification Error</h2>
<p><img src="CS5590_images/chrome_CNeo323E9V.png" class="img-fluid"></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Precision = How many retrieved items are relevant? <br> Recall = How many relevant items are retrieved?</p>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>sensitivity = Probability of positive test given a patient has a disease.<br> Specificity = Probability of a negative test given a patient is well.<br>Specificity = 1 - False Alarm</p>
</div>
</div>
</section>
<section id="utility-and-cost" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="utility-and-cost"><span class="header-section-number">4</span> Utility and cost</h2>
<ul>
<li>Detection Cost:
<ul>
<li>cost = <span class="math inline">C_{\mathrm{FP}} \times \mathrm{FP}+C_{\mathrm{FN}} \times \mathrm{FN}</span></li>
</ul></li>
<li>Fmeasure
<ul>
<li><span class="math inline">F1=\frac{2\times \left(\mathrm{Recall}\times \mathrm{Precision}\right)}{\mathrm{Recall}+\mathrm{Precision}}</span></li>
</ul></li>
</ul>
</section>
<section id="roc-curve" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="roc-curve"><span class="header-section-number">5</span> ROC curve</h2>
<ul>
<li>Receiver Operative Curve</li>
<li>Plot between True positive rate on y axis and False positive rate on x axis</li>
<li>AUC : Area under the curve, higher the area, better the performance</li>
</ul>
<p>A Receiver Operating Characteristic (ROC) curve plots the TP rate vs.&nbsp;the FP rate as a threshold on the confidence of an instance being positive is varied : <br><br> <img src="CS5590_images/Acrobat_LfrCm8Z5SQ.png" class="img-fluid"> <br><br> <img src="CS5590_images/MATLAB_eYMZjl3LEJ.png" class="img-fluid"></p>
</section>
<section id="precision-recall-curve" class="level2" data-number="6">
<h2 data-number="6" class="anchored" data-anchor-id="precision-recall-curve"><span class="header-section-number">6</span> Precision Recall Curve</h2>
<ul>
<li>Plot between Precision on y axis and recall (TPR) on x axis. It is used for class imbalanced dataset mostly, It is also used when we can not calculate True Negative.</li>
</ul>
<p>A precision/recall curve plots the precision vs.&nbsp;recall (TP rate) as a threshold on the confidence of an instance being positive is varied. <br><br> <img src="CS5590_images/Acrobat_jfeedglqjh.png" class="img-fluid"></p>
</section>
<section id="a-nice-way-to-define-precision-recall-etc." class="level2" data-number="7">
<h2 data-number="7" class="anchored" data-anchor-id="a-nice-way-to-define-precision-recall-etc."><span class="header-section-number">7</span> A nice way to define precision recall etc.</h2>
<p>Consider <span class="math inline">Y</span> as <code>true label</code> and <span class="math inline">\hat{Y}</span> as <code>predicted label</code>.</p>
<ul>
<li>precision <span class="math inline">=P\left(Y=1|\;\hat{Y} =1\right)</span></li>
<li>Recall (TPR) <span class="math inline">=P\left(\hat{Y} =1|\;Y=1\right)</span></li>
<li>False positive Rate (FPR) <span class="math inline">=P\left(\hat{Y} =1|\;Y=0\right)</span></li>
<li>True Negative Rate (TNR)= <span class="math inline">=P\left(\hat{Y} =0|\;Y=0\right)</span> <br><br></li>
</ul>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Notice that TPR and FPR which makes ROC curve is conditioned on the <code>true value</code>, and precision which is used in PR curve is conditioned on <code>predicted label</code>. This is the reason, PR curve is used for class imbalanced dataset, or where positive class is more interesting then negative class.<br> <a href="https://stats.stackexchange.com/questions/7207/roc-vs-precision-and-recall-curves">If question is: <em>“How meaningful is a positive result from my classifier given the baseline probabilities of my problem?”</em>, use a PR curve. If question is, <em>“How well can this classifier be expected to perform in general, at a variety of different baseline probabilities?”</em>, go with a ROC curve.</a></p>
</div>
</div>
</section>
<section id="roc-curve-vs-pr-curve" class="level2" data-number="8">
<h2 data-number="8" class="anchored" data-anchor-id="roc-curve-vs-pr-curve"><span class="header-section-number">8</span> ROC curve vs PR curve</h2>
<p>Consider a dataset having 100 positive cases and 10,000 negative cases. Now consider 2 classifiers <span class="math inline">A</span> and <span class="math inline">B</span>. <span class="math inline">A</span> predicts 9 as true positive, 40 as false positive whereas <span class="math inline">B</span> predicts 9 as true positive 1000 as false positive.<br> We can observe that as both the classifier predicts 9 out of 10 as true positive so both has same recall value, also FPR is small(as it can be seen in below picture), so the ROC curve which is drawn between recall (TPR) and FPR, will not differentiate among the two classifier. <br> But PR curve which is drawn between precision and recall, will look totally different here as both has different precision.</p>
<div class="cell" data-execution_count="25">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_conf_matrix_labels(cf_matrix):</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>    group_names <span class="op">=</span> [<span class="st">'True Neg'</span>,<span class="st">'False Pos'</span>,<span class="st">'False Neg'</span>,<span class="st">'True Pos'</span>]</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    group_counts <span class="op">=</span> [<span class="st">'</span><span class="sc">{0:0.0f}</span><span class="st">'</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span> cf_matrix.flatten()]</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>    group_percentages <span class="op">=</span> [<span class="st">'</span><span class="sc">{0:.2%}</span><span class="st">'</span>.<span class="bu">format</span>(value) <span class="cf">for</span> value <span class="kw">in</span> cf_matrix.flatten()<span class="op">/</span>np.<span class="bu">sum</span>(cf_matrix)]</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> [<span class="ss">f'</span><span class="sc">{</span>v1<span class="sc">}</span><span class="ch">\n</span><span class="sc">{</span>v2<span class="sc">}</span><span class="ch">\n</span><span class="sc">{</span>v3<span class="sc">}</span><span class="ss">'</span> <span class="cf">for</span> v1, v2, v3 <span class="kw">in</span> <span class="bu">zip</span>(group_names,group_counts,group_percentages)]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    labels <span class="op">=</span> np.asarray(labels).reshape(cf_matrix.shape[<span class="dv">0</span>],cf_matrix.shape[<span class="dv">1</span>])</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    accuracy  <span class="op">=</span> np.trace(cf_matrix) <span class="op">/</span> <span class="bu">float</span>(np.<span class="bu">sum</span>(cf_matrix))</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    precision <span class="op">=</span> cf_matrix[<span class="dv">1</span>,<span class="dv">1</span>] <span class="op">/</span> <span class="bu">sum</span>(cf_matrix[:,<span class="dv">1</span>])</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    recall    <span class="op">=</span> cf_matrix[<span class="dv">1</span>,<span class="dv">1</span>] <span class="op">/</span> <span class="bu">sum</span>(cf_matrix[<span class="dv">1</span>,:])</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>    fpr    <span class="op">=</span> cf_matrix[<span class="dv">0</span>,<span class="dv">1</span>] <span class="op">/</span> <span class="bu">sum</span>(cf_matrix[<span class="dv">0</span>,:])</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>    stats_text <span class="op">=</span> <span class="st">"</span><span class="ch">\n\n</span><span class="st">Accuracy=</span><span class="sc">{:0.3f}</span><span class="ch">\n</span><span class="st">Precision=</span><span class="sc">{:0.3f}</span><span class="ch">\n</span><span class="st">Recall=</span><span class="sc">{:0.3f}</span><span class="ch">\n</span><span class="st">FPR=</span><span class="sc">{:0.4f}</span><span class="st">"</span>.<span class="bu">format</span>(</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                accuracy,precision,recall,fpr)    </span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> labels,stats_text</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>YTrue <span class="op">=</span> np.hstack([np.ones(<span class="dv">10</span>),np.zeros(<span class="dv">100000</span>)]) <span class="co"># data with 100 positive and 10,000 negative cases</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>yPredA <span class="op">=</span> np.hstack([np.ones(<span class="dv">9</span>),np.zeros(<span class="dv">1</span>),np.ones(<span class="dv">40</span>),np.zeros(<span class="dv">99960</span>)]) <span class="co"># A predicts 9 True positive, 40 False  Positive,</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>yPredB <span class="op">=</span> np.hstack([np.ones(<span class="dv">9</span>),np.zeros(<span class="dv">1</span>),np.ones(<span class="dv">1000</span>),np.zeros(<span class="dv">99000</span>)]) <span class="co"># B predicts 9 True positive, 1000 False positive</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>cf_matrixA <span class="op">=</span> confusion_matrix(YTrue, yPredA)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>cf_matrixB <span class="op">=</span> confusion_matrix(YTrue, yPredB)</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">2</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>axis_labels <span class="op">=</span> [<span class="st">'Negative Class'</span>,<span class="st">'Positive Class'</span>]</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>labels,stats_text<span class="op">=</span>get_conf_matrix_labels(cf_matrixA)</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cf_matrixA, annot<span class="op">=</span>labels, fmt<span class="op">=</span><span class="st">''</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>,ax<span class="op">=</span>ax[<span class="dv">0</span>],cbar<span class="op">=</span><span class="va">False</span>,xticklabels<span class="op">=</span>axis_labels, yticklabels<span class="op">=</span>axis_labels)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Classifier A'</span>)</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_xlabel(<span class="st">'Predicted label'</span><span class="op">+</span>stats_text)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylabel(<span class="st">'True label'</span>)</span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>labels,stats_text<span class="op">=</span>get_conf_matrix_labels(cf_matrixB)</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>sns.heatmap(cf_matrixB, annot<span class="op">=</span>labels, fmt<span class="op">=</span><span class="st">''</span>, cmap<span class="op">=</span><span class="st">'Blues'</span>,ax<span class="op">=</span>ax[<span class="dv">1</span>],cbar<span class="op">=</span><span class="va">False</span>,xticklabels<span class="op">=</span>axis_labels, yticklabels<span class="op">=</span>axis_labels)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Classifier B'</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_xlabel(<span class="st">'Predicted label'</span><span class="op">+</span>stats_text)</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">'True label'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-display">
<p><img src="2022-08-20-CS5590-week2_files/figure-html/cell-2-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>Accuracy also is not a good measure in above case. As both the classifier has similar accuracy.</p>
</section>
<section id="other-performance-measures" class="level2" data-number="9">
<h2 data-number="9" class="anchored" data-anchor-id="other-performance-measures"><span class="header-section-number">9</span> Other performance measures</h2>
<ul>
<li>Kullback-Leibler Diverfence : <span class="math inline">D_{\mathrm{KL}} \left(P\|Q\right)=\sum_i P\left(i\right)\log \frac{P\left(i\right)}{Q\left(i\right)}</span></li>
<li>Gini Statistic : <span class="math inline">2\times \mathrm{AUC}-1</span></li>
<li>F1 score: <span class="math inline">\frac{2\times \left(\mathrm{Recall}\times \mathrm{Precision}\right)}{\mathrm{Recall}+\mathrm{Precision}}</span></li>
<li>Akaike Information Criterion (AIC): <span class="math inline">2k-2\ln \left(L\right)</span>, here <span class="math inline">k</span> is number of model parameters, L is max value of the Likelihood function for the model</li>
</ul>
</section>
<section id="important-points" class="level2" data-number="10">
<h2 data-number="10" class="anchored" data-anchor-id="important-points"><span class="header-section-number">10</span> Important points</h2>
<ul>
<li>Randomization of data is essential so that held-aside test data can be really representative of new data.</li>
<li>Test set should never be used in any way for normalization, hyper parameter tuning etc.</li>
<li>Any preprocessing done over entire data set ( feature selection, parameter tuning, threshold selection ) must not use labels from test set.</li>
</ul>
</section>
<section id="k-nearest-neighbors" class="level2" data-number="11">
<h2 data-number="11" class="anchored" data-anchor-id="k-nearest-neighbors"><span class="header-section-number">11</span> K-Nearest Neighbors</h2>
<section id="basic-idea" class="level3" data-number="11.1">
<h3 data-number="11.1" class="anchored" data-anchor-id="basic-idea"><span class="header-section-number">11.1</span> basic idea</h3>
<ul>
<li>If it walks like a duck, quacks like a duck , then it’s probably a duck.</li>
<li>If data points are represented well then KNN works well.</li>
<li>choosing K is important, if K is too small then it becomes sensitive to noise point. If k is too large, neighborhood may incudes points from other class.</li>
<li>Euclidean distance between two instance <span class="math inline">d\left(X_i ,X_j \right)=\sqrt{\sum_{r=1}^n {\left(a_r \left(X_i \right)-a_r{\left(X_j \right)} \right)}^2 }</span> here <span class="math inline">a_i \left(X\right)\;</span> denotes features.</li>
<li>In case of continuous valued target function, Mean value of K nearest training examples is taken</li>
</ul>
</section>
<section id="how-to-determinke-k" class="level3" data-number="11.2">
<h3 data-number="11.2" class="anchored" data-anchor-id="how-to-determinke-k"><span class="header-section-number">11.2</span> How to determinke K</h3>
<ul>
<li>experiment with different value of K starting form 1 on test set to validate the error, in case of binary classification use odd number for k to avoid ties.<br></li>
</ul>
<p>KNN is a transductive method, there is no training involved , it is refereed as Lazy learning, Learning is just storing all the training instances <br> Similar Keywords: KNN, Memory Based Reasoning, Example Based Reasoning, Instance Based Learning, Case Based Reasoning, Lazy Learning<br> Voronoi Diagram: Decision surface formed by the training Examples for 1 nearest neighbors classifier<br></p>
</section>
<section id="improvements" class="level3" data-number="11.3">
<h3 data-number="11.3" class="anchored" data-anchor-id="improvements"><span class="header-section-number">11.3</span> Improvements</h3>
<ul>
<li>Distance weighted Nearest Neighbors</li>
<li>Scaling (normalization) attributes for fair computation fo distances</li>
<li>Measure “closeness” differently</li>
<li>Finding “close” example in large training set quickly , eg Efficient memory indexing using kd-tree</li>
</ul>
</section>
<section id="pros" class="level3" data-number="11.4">
<h3 data-number="11.4" class="anchored" data-anchor-id="pros"><span class="header-section-number">11.4</span> Pros</h3>
<ul>
<li>Highly effective transductive inference method for noisy training data and complex target functions.</li>
<li>Target function for a whole space may be described as a combinations of less complex local approximations</li>
<li>Trains very fast (Lazy Learner)</li>
</ul>
</section>
<section id="cons" class="level3" data-number="11.5">
<h3 data-number="11.5" class="anchored" data-anchor-id="cons"><span class="header-section-number">11.5</span> Cons</h3>
<ul>
<li>Curse of dimensionality</li>
<li>Storage: all training example are saved in memory</li>
<li>slow at query time, can be overcome by pre sorting and indexing training samples.</li>
</ul>
</section>
<section id="convergence-of-1-nn" class="level3" data-number="11.6">
<h3 data-number="11.6" class="anchored" data-anchor-id="convergence-of-1-nn"><span class="header-section-number">11.6</span> Convergence of 1-NN</h3>
<p><span class="math inline">P\left(\mathrm{KNNError}\right)=2\left(\mathrm{Bayes}\;\mathrm{Optimal}\;\mathrm{Error}\;\mathrm{Rate}\right)</span><br> Probability of K NN error is at most twice the bayes optimal error, bayes optimal error is best(least) error we can get using machine learning <br> It is Possible to show that: as the size of training data set approaches infinity, the one nearest neighbor classifier guarantees an error rate of no worse than twice the bayes error rate ( the minimum achievable error rate given the distribution of the data).</p>
</section>
<section id="density-estimation-using-knn" class="level3" data-number="11.7">
<h3 data-number="11.7" class="anchored" data-anchor-id="density-estimation-using-knn"><span class="header-section-number">11.7</span> Density Estimation using KNN</h3>
<p>Non parametric Density Estimation using KNN. <br> nstead of fixing bin width h and counting the mumber of instances, fix the instances(neighbors) k and check bin width <span class="math inline">\hat{p} \left(X\right)=\frac{k}{2{\mathrm{Nd}}_k \left(X\right)}</span> here <span class="math inline">d_k \left(X\right)</span> is the <span class="math inline">k_{\mathrm{th}}</span> closest distance to to <span class="math inline">X</span> , This is also known as <strong>Parzen density estimation</strong>.</p>
</section>
<section id="knn-example-using-sklearn" class="level3" data-number="11.8">
<h3 data-number="11.8" class="anchored" data-anchor-id="knn-example-using-sklearn"><span class="header-section-number">11.8</span> KNN example using sklearn</h3>
<p>Import libraries</p>
<div class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.colors <span class="im">import</span> ListedColormap</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> neighbors, datasets</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>iris <span class="op">=</span> datasets.load_iris()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Print shapes and class information</p>
<div class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'features: '</span>,iris.feature_names)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'target: '</span>,iris.target)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'classess: '</span>,iris.target_names)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> iris.data</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> iris.target</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'input  data shape:'</span>,X.shape)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'target shape: '</span>,y.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>features:  ['sepal length (cm)', 'sepal width (cm)', 'petal length (cm)', 'petal width (cm)']
target:  [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 2
 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2
 2 2]
classess:  ['setosa' 'versicolor' 'virginica']
input  data shape: (150, 4)
target shape:  (150,)</code></pre>
</div>
</div>
<p>Plot the data</p>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>plt.scatter(iris.data[:,<span class="dv">1</span>],iris.data[:,<span class="dv">2</span>],c<span class="op">=</span>iris.target, cmap<span class="op">=</span>plt.cm.Paired)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>plt.xlabel(iris.feature_names[<span class="dv">1</span>])</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>plt.ylabel(iris.feature_names[<span class="dv">2</span>])</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>plt.scatter(iris.data[:,<span class="dv">0</span>],iris.data[:,<span class="dv">3</span>],c<span class="op">=</span>iris.target, cmap<span class="op">=</span>plt.cm.Paired)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(iris.feature_names[<span class="dv">0</span>])</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(iris.feature_names[<span class="dv">3</span>])</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-08-20-CS5590-week2_files/figure-html/cell-5-output-1.png" class="img-fluid"></p>
</div>
<div class="cell-output cell-output-display">
<p><img src="2022-08-20-CS5590-week2_files/figure-html/cell-5-output-2.png" class="img-fluid"></p>
</div>
</div>
<p>split the dataset into test set and train set</p>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>X_train, X_test, y_train, y_test <span class="op">=</span> train_test_split(X,y, test_size<span class="op">=</span><span class="fl">0.2</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Fit the classifier with different values of k</p>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.neighbors <span class="im">import</span> KNeighborsClassifier</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>k_range <span class="op">=</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">26</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>scores <span class="op">=</span> {}</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>scores_list <span class="op">=</span> []</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> k_range:</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>        knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span>k)</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>        knn.fit(X_train,y_train)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>        y_pred<span class="op">=</span>knn.predict(X_test)</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>        scores[k] <span class="op">=</span> metrics.accuracy_score(y_test,y_pred)</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>        scores_list.append(metrics.accuracy_score(y_test,y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Plot the scores:</p>
<div class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot the relationship between K and the testing accuracy</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>plt.plot(k_range,scores_list)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">'Value of K for KNN'</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">'Testing Accuracy'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="2022-08-20-CS5590-week2_files/figure-html/cell-8-output-1.png" class="img-fluid"></p>
</div>
</div>
<p>chose the best value of K for final model.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>In KNN, finding the value of k is not easy. A small value of k means that noise will have a higher influence on the result and a large value make it computationally expensive. Data scientists usually choose as an odd number if the number of classes is 2 and another simple approach to select k is set <code>k=sqrt(n)</code>. There is one more widely used method called <code>Elbow Method</code> which is also used to find the value of K, here we plot error rate vs k value and chose k value at elbow point.</p>
</div>
</div>
<div class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>knn <span class="op">=</span> KNeighborsClassifier(n_neighbors<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>knn.fit(X_train,y_train)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion metrics</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> confusion_matrix</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'confusion matrix on test data: '</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(confusion_matrix(y_test, y_pred))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>confusion matrix on test data: 
[[11  0  0]
 [ 0 13  0]
 [ 0  0  6]]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'classification report on test data:'</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred, target_names<span class="op">=</span>iris.target_names))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>classification report on test data:
              precision    recall  f1-score   support

      setosa       1.00      1.00      1.00        11
  versicolor       1.00      1.00      1.00        13
   virginica       1.00      1.00      1.00         6

    accuracy                           1.00        30
   macro avg       1.00      1.00      1.00        30
weighted avg       1.00      1.00      1.00        30
</code></pre>
</div>
</div>
<p><br><br><br> <span class="math inline">\tiny {\textcolor{#808080}{\boxed{\text{Reference: Dr. Vineeth, IIT Hyderabad }}}}</span></p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="abhiyantaabhishek/IITH-Data-Science" data-repo-id="R_kgDOILoB8A" data-category="Announcements" data-category-id="DIC_kwDOILoB8M4CSJcL" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../posts/CS5590/2022-08-06-CS5590-week1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Machine Learning 1</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../posts/CS5590/2022-08-27-CS5590-week3.html" class="pagination-link">
        <span class="nav-page-text">Machine Learning 3</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">Copyright 2022, Abhishek Kumar Dubey</div>   
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/abhiyantaabhishek">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/abhishek-kumar-dubey-585a86179/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>



</body></html>